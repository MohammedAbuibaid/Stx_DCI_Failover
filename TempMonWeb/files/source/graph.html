<html>
	<head>

	</head>
	<body>
		<canvas id="" width="" height=""></canvas>
		<br>
		<label for="filterSelect">Result Filter Method:</label>
		<br>
		<select id="filterSelect">
			<option value="time" selected="">Filter by time</option>
			<option value="count">Filter by number of results</option>
		</select>
		<br><br>
		<div id="timeDiv">
			<label for="timeSelect">Use results from last:</label>
			<br>
			<select id="timeSelect">
				<option value="300">5 minutes</option>
				<option value="3600" selected="">Hour</option>
				<option value="43200">12 hours</option>
				<option value="86400">24 hours</option>
				<option value="604800">Week</option>
				<option value="2592000">Month</option>
			</select>
		</div>
		<div id="countDiv" style="display: none;">
			<label for="countSelect">Use last:</label>
			<br>
			<select id="countSelect">
				<option value=10>10 results</option>
				<option value=50>50 results</option>
				<option value=100 selected="">100 results</option>
				<option value=500>500 results</option>
				<option value=1000>1000 results</option>
			</select>
		</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.js"></script>
<script>
	var URL = "/";

	window.onload = async () => {
		updateChart(await getResults({
			"filter": "timestamp",
			"min": (Date.now() / 1000) - 3600,
			"results": 1000
		}));

		let filterSelect = document.querySelector("#filterSelect");
		let timeSelect = document.querySelector("#timeSelect");
		let countSelect = document.querySelector("#countSelect");

		// Should make it so that when filterSelect is changed, the chart is updated using the current
		// value of the newly visible selector
		filterSelect.addEventListener("change", (event) => {
			if (event.target.value == "count") {
				document.querySelector("#timeDiv").style.display = "none";
				document.querySelector("#countDiv").style.display = "block";
			} else if (event.target.value == "time") {
				document.querySelector("#timeDiv").style.display = "block";
				document.querySelector("#countDiv").style.display = "none";
			}
		});


		timeSelect.addEventListener("change", async (event) => {
			updateChart(await getResults({
				"filter": "timestamp",
				"min": (Date.now() / 1000) - parseInt(event.target.value),
				"results": 1000
			}));
		});

		countSelect.addEventListener("change", async (event) => {
			updateChart(await getResults({
				"results": parseInt(event.target.value)
			}));
		});
	}

	function updateChart(results) {
	}

	async function getResults(filter) {
		let url = URL + "?";
		Object.entries(filter).forEach((entry) => {
			url += `${entry[0]}=${entry[1]}&`;
		});
		console.log(url);

	}

</script>
	</body>
</html>
